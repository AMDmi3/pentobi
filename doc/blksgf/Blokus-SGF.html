<html>
  <head>
    <title>Blokus SGF Files</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  </head>
  <body>

    <h1>Blokus SGF Files</h1>
    <small>
      Author: Markus Enzenberger
    </small>

    <p>
      This document describes the file format for
      <a href="http://en.wikipedia.org/wiki/Blokus">Blokus</a>
      games as used by the program
      <a href="http://pentobi.sourceforge.net">Pentobi</a>.
      The most recent version of this document can be found in the source
      distribution of Pentobi in the folder pentobi/doc/blksgf.
    </p>

    <h2>Introduction</h2>
    <p>
      The file format is a derivative of the
      <a href="http://www.red-bean.com/sgf/">Smart Game Format</a> (SGF).
      The current SGF version 4 does not define standard properties for Blokus.
      Therefore, a number of game-specific properties and value types
      had to be defined.
      The definitions follow the recommendations of SGF 4 and the proposals
      for multi-player games from the discussions about the future SGF version
      5.
    </p>

    <h2>File extension and MIME type</h2>
    <p>
      The file extension <tt>.blksgf</tt> and the
      <a href="http://en.wikipedia.org/wiki/Internet_media_type">MIME type</a>
      <tt>application/x-blokus-sgf</tt> are used for Blokus SGF files.
    </p>
    <p>
      <b>Note</b><br/>
      Since this is a non-standard MIME type, links to Blokus SGF files on web
      servers will not automatically open the file with Pentobi even if Pentobi
      is installed locally and registered as a handler for Blokus SGF files.
      To make this work, you can put a file named
      <a href="http://en.wikipedia.org/wiki/.htaccess">.htaccess</a> on the web
      server in the same directory that contains the .blksgf files or in
      one of its parent directories.
      This file needs to contain the line:
      <blockquote>
      AddType application/x-blokus-sgf blksgf
      </blockquote>
    </p>

    <h2>Character set</h2>
    <p>
      Although not specific to Blokus, it is recommended to use
      <a href="http://en.wikipedia.org/wiki/UTF-8">UTF-8</a> as the character
      set.
      Pentobi always writes files in UTF-8 and indicates that with the
      <tt>CA</tt> property in the file.
      Pentobi can read SGF files encoded in UTF-8 or Latin1.
    </p>

    <h2>Game property</h2>
    <p>
      Since there is no number for Blokus defined in SGF 4, a string
      instead of a number is used as the value for the <tt>GM</tt> property.
      Currently, the following strings are used:
      <ul>
	<li><tt>Blokus</tt></li>
	<li><tt>Blokus Two-Player</tt></li>
	<li><tt>Blokus Duo</tt></li>
	<li><tt>Blokus Trigon</tt></li>
	<li><tt>Blokus Trigon Two-Player</tt></li>
	<li><tt>Blokus Trigon Three-Player</tt></li>
      </ul>
      The strings are case-sensitive, words are separated by exactly one space
      and no additional whitespace at the beginning or end of the string is
      allowed.
    </p>

    <h2>Color and player properties</h2>
    <p>
      In game variants with two players and two colors, <tt>B</tt> denotes the
      first player or color, <tt>W</tt> the second player or color.
      In game variants with three or four players and one color per player,
      <tt>1</tt>, <tt>2</tt>, <tt>3</tt>, <tt>4</tt> denote the first, second,
      third, and fourth player or color.
      In game variants with two players and four colors, <tt>B</tt> denotes the
      first player, <tt>W</tt> the second player, and <tt>1</tt>, <tt>2</tt>,
      <tt>3</tt>, <tt>4</tt> denote the first, second, third, and fourth color.
      This applies to move properties and properties related to a player
      or a color.
    </p>
    <p>
      Example 1: in the game variant Blokus Two-Player <tt>PW</tt>
      is the name of the first player, and <tt>1</tt> is a move of the
      first color.
    </p>
    <p>
      Example 2: in the game variant Blokus Two-Player, one could either use
      the <tt>BL</tt>, <tt>WL</tt> properties to indicate the time left
      for a player, if the game is played with a time limit for each player,
      or one could use the <tt>1L</tt>, <tt>2L</tt>, <tt>3L</tt>, <tt>4L</tt>
      properties to indicate the time left for a color, if the game is played
      with a time limit for each color. (This is only an example how the
      properties should be interpreted. Pentobi currently has no support for
      game clocks).
    </p>
    <p>
      <b>Note</b><br/>
      Old versions of Pentobi (before version 0.2) used the properties
      <tt>BLUE</tt>, <tt>YELLOW</tt>, <tt>RED</tt>, <tt>GREEN</tt>
      in the four-color game variants, which did not reflect the current state
      of discussion for SGF 5.
      Current versions of Pentobi can still read games containing the old
      properties but they are deprecated and should no longer be used.
    </p>

    <h2>Coordinate system</h2>
    <p>
      Fields on the board (called points in SGF) are identified by a
      case-insensitive string with a letter for the column followed by a
      number for the row.
      The letters start with 'a', the numbers start with '1'.
      The lower left corner of the board is 'a1'.
      The strings are not allowed to contain whitespaces.
      Note that, unlike the common convention in the game of Go, the letter
      'j' is used.
    </p>
    <p>
      If there are more than 26 columns, the columns continue with 'aa', 'ab',
      ..., 'ba', 'bb', ... More than 26 columns are presently required for the
      game variant Trigon and may be required for supporting future game
      variants on rectangular boards larger than 20&times;20.
    </p>

    <p>
      For Trigon, hexagonal boards are mapped to rectangular coordinates
      as in the following example of a hexagon with edge size 3:
      <pre>
       6     / \ / \ / \ / \
       5   / \ / \ / \ / \ / \
       4 / \ / \ / \ / \ / \ / \
       3 \ / \ / \ / \ / \ / \ /
       2   \ / \ / \ / \ / \ /
       1     \ / \ / \ / \ /
          a b c d e f g h i j k
      </pre>
    </p>

    <h2>Move properties</h2>
    <p>
      The value of a move property is a string with the coordinates of the
      played piece on the board separated by commas.
      No whitespace characters are allowed before, after, or in-between
      the coordinates.
    </p>
    <p>
      Example: <tt>B[f9,e10,f10,g10,f11]</tt>
    </p>
    <p>
      <b>Note</b><br/>
      Old versions of Pentobi (before version 0.3) used to represent moves by a
      list of points, which did not follow the convention used by other games
      in SGF to use single-value properties for moves.
      Current versions of Pentobi can still read games containing the old
      move property values but they are deprecated and should no longer be used.
    </p>

    <h2>Setup properties</h2>
    <p>
      Setup properties are currently not used but they might be used in the
      future.
      Therefore, a program that reads Blokus SGF files should already check
      nodes for the setup properties <tt>AB</tt>, <tt>AW</tt>, <tt>A1</tt>,
      <tt>A2</tt>, <tt>A3</tt>, <tt>A4</tt>, <tt>AE</tt> and display an error
      message if they are found.
      Setup properties cannot be silently ignored because the program would
      misinterpret the board state if it reads a file written by a future
      version of Pentobi that uses setup properties.
    </p>
  </body>
</html>
